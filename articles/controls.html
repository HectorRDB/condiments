<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>More controls for the tests used in the condiments workflow • condiments</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="More controls for the tests used in the condiments workflow">
<meta property="og:description" content="condiments">
<meta property="og:image" content="http://hectorrdb.github.io//condiments/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">condiments</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/condiments.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/controls.html">More controls for the tests used in the condiments workflow</a>
    </li>
    <li>
      <a href="../articles/examples.html">Generating toy datasets</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HectorRDB/condiments">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="controls_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>More controls for the tests used in the condiments workflow</h1>
                        <h4 class="author">Hector Roux de Bézieux</h4>
            
            <h4 class="date">07 April , 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HectorRDB/condiments/blob/master/vignettes/controls.Rmd"><code>vignettes/controls.Rmd</code></a></small>
      <div class="hidden name"><code>controls.Rmd</code></div>

    </div>

    
    
<p>This vignette is made for users that are already familiar with the basic <em>condiments</em> workflow described in <a href="https://hectorrdb.github.io/condiments/articles/condiments.html">the first vignette</a>. Here, we will show how to modify the default parameters for the first two steps of the workflow</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For analysis</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hectorrdb.github.io/condiments/index.html">condiments</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">slingshot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span></code></pre></div>
<div id="toy-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#toy-dataset" class="anchor"></a>Toy dataset</h1>
<p>We rely on the same toy dataset as the first vignette</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"toy_dataset"</span>, package <span class="op">=</span> <span class="st">"condiments"</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">toy_dataset</span><span class="op">$</span><span class="va">sd</span>
<span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dim1"</span>, <span class="st">"Dim2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingshot.html">slingshot</a></span><span class="op">(</span><span class="va">rd</span>, <span class="va">df</span><span class="op">$</span><span class="va">cl</span><span class="op">)</span></code></pre></div>
</div>
<div id="the-topologytest-function" class="section level1">
<h1 class="hasAnchor">
<a href="#the-topologytest-function" class="anchor"></a>The <strong>topologyTest</strong> function</h1>
<p>By default, the <strong>topologyTest</strong> function requires only two inputs, the <code>sds</code> object and the <code>condition</code> labels. To limit run time for the vignette, we also change the default number of permutations used to generate trajectories under the null by setting the <code>rep</code> argument to <span class="math inline">\(10\)</span> instead of the default <span class="math inline">\(100\)</span>. As such, the test statistics might be more variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topologyTest.html">topologyTest</a></span><span class="op">(</span>sds <span class="op">=</span> <span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, rep <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>## Generating permuted trajectories</code></pre>
<pre><code>## Running KS-mean test</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">top_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">method</th>
<th align="left">thresh</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">KS_mean</td>
<td align="left">0.01</td>
<td align="right">0</td>
<td align="right">1</td>
</tr></tbody>
</table>
<div id="changing-the-method-or-the-threshold" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-the-method-or-the-threshold" class="anchor"></a>Changing the method or the threshold</h2>
<p>The <strong>topologyTest</strong> function can be relatively slow on large datasets. Moreover, when changing the method used to test the null hypothesis that a common trajectory should be fitted, the first permutation part of generating <code>rep</code> trajectories under the null is identical. Therefore, we allow users to specify more than one method and one value of the threshold. Here, we will use both the Kolmogorov-Smirnov test test<span class="citation">(Smirnov 1939)</span> and the classifier-test<span class="citation">(Lopez-Paz and Oquab 2016)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topologyTest.html">topologyTest</a></span><span class="op">(</span>sds <span class="op">=</span> <span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, rep <span class="op">=</span> <span class="fl">10</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"KS_mean"</span>, <span class="st">"Classifier"</span><span class="op">)</span>,
                        threshs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.01</span>, <span class="fl">.05</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Generating permuted trajectories</code></pre>
<pre><code>## Running KS-mean test</code></pre>
<pre><code>## Running Classifier test</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">top_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">method</th>
<th align="left">thresh</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">KS_mean</td>
<td align="left">0</td>
<td align="right">0.0070000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">KS_mean</td>
<td align="left">0.01</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">KS_mean</td>
<td align="left">0.05</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">KS_mean</td>
<td align="left">0.1</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">Classifier</td>
<td align="left">0</td>
<td align="right">0.3816667</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">Classifier</td>
<td align="left">0.01</td>
<td align="right">0.4066667</td>
<td align="right">0.9999972</td>
</tr>
<tr class="odd">
<td align="left">Classifier</td>
<td align="left">0.05</td>
<td align="right">0.3333333</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">Classifier</td>
<td align="left">0.1</td>
<td align="right">0.2583333</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>To see all methods avaible, use /usr/local/lib/R/site-library/condiments/help/topologyTest and look at the <code>methods</code> argument.</p>
</div>
<div id="passing-arguments-to-the-test-method" class="section level2">
<h2 class="hasAnchor">
<a href="#passing-arguments-to-the-test-method" class="anchor"></a>Passing arguments to the test method</h2>
<p>For all methods but the KS test, additional paramters can be specified, using a custom argument: <code>args_classifier</code>, <code>args_wass</code> or <code>args_mmd</code>. See the help file for given test more information on those parameters. For example, since the default test based on the wasserstein distance and permutation test is quite slow, we can pass a <code>fast</code> argument.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topologyTest.html">topologyTest</a></span><span class="op">(</span>sds <span class="op">=</span> <span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, rep <span class="op">=</span> <span class="fl">10</span>,
                        methods <span class="op">=</span> <span class="st">"wasserstein_permutation"</span>,
                        args_wass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fast <span class="op">=</span> <span class="cn">TRUE</span>, S <span class="op">=</span> <span class="fl">100</span>, iterations  <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Generating permuted trajectories</code></pre>
<pre><code>## Running wassertsein permutation test</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">top_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">method</th>
<th align="left">thresh</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">wasserstein_permutation</td>
<td align="left">NA</td>
<td align="right">1.525219</td>
<td align="right">0.72</td>
</tr></tbody>
</table>
</div>
<div id="using-parallelisation" class="section level2">
<h2 class="hasAnchor">
<a href="#using-parallelisation" class="anchor"></a>Using parallelisation</h2>
<p>For now, the first part of the <strong>topologyTest</strong> has been designed for parallelisation using the <em>BiocParallel</em> package. For example, to run with 4 cores, you can run the following command</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel">BiocParallel</a></span><span class="op">)</span>
<span class="va">BPPARAM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">BPPARAM</span><span class="op">$</span><span class="va">progressbar</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="va">BPPARAM</span><span class="op">$</span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">top_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topologyTest.html">topologyTest</a></span><span class="op">(</span>sds <span class="op">=</span> <span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, rep <span class="op">=</span> <span class="fl">100</span>, 
                        parallel <span class="op">=</span> <span class="cn">TRUE</span>, BPPARAM <span class="op">=</span> <span class="va">BPPARAM</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">top_res</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="differential-progression-and-differentiation" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-progression-and-differentiation" class="anchor"></a>Differential progression and differentiation</h1>
<p>The tests for the second test are much less compute-intensive, therefore there is no parallelisation. However, the other changes introduce in the previous section are still possible</p>
<div id="default" class="section level2">
<h2 class="hasAnchor">
<a href="#default" class="anchor"></a>Default</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prog_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressionTest.html">progressionTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">prog_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">lineage</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">All</td>
<td align="right">6.665207</td>
<td align="right">0</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dif_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/differentiationTest.html">differentiationTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span><span class="op">)</span></code></pre></div>
<pre><code>## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .
## 
## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">dif_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pair</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">1vs2</td>
<td align="right">0.6521622</td>
<td align="right">2.9e-06</td>
</tr></tbody>
</table>
</div>
<div id="changing-the-method-and-or-threshold" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-the-method-and-or-threshold" class="anchor"></a>Changing the method and / or threshold</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prog_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressionTest.html">progressionTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, method <span class="op">=</span> <span class="st">"Classifier"</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">prog_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">lineage</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">All</td>
<td align="right">0.5800901</td>
<td align="right">0.0093097</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dif_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/differentiationTest.html">differentiationTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, thresh <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></code></pre></div>
<pre><code>## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .
## 
## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">dif_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pair</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">1vs2</td>
<td align="right">0.6211712</td>
<td align="right">0.0001764</td>
</tr></tbody>
</table>
</div>
<div id="passing-more-parameters-to-the-test-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#passing-more-parameters-to-the-test-methods" class="anchor"></a>Passing more parameters to the test methods</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prog_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/progressionTest.html">progressionTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span>, method <span class="op">=</span> <span class="st">"Classifier"</span>,
                            args_classifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rf"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range

## Warning in randomForest.default(x, y, mtry = param$mtry, ...): invalid mtry:
## reset to within valid range</code></pre>
<pre><code>## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">prog_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">lineage</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">All</td>
<td align="right">0.5845946</td>
<td align="right">0.0064207</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dif_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/differentiationTest.html">differentiationTest</a></span><span class="op">(</span><span class="va">sds</span>, conditions <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">conditions</span><span class="op">)</span></code></pre></div>
<pre><code>## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .
## 
## note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">dif_res</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pair</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">1vs2</td>
<td align="right">0.6206306</td>
<td align="right">0.0001764</td>
</tr></tbody>
</table>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>For all of the above procedures, it is important to note that we are making multiple comparisons. The p-values we obtain from these tests should be corrected for multiple testing, especially for trajectories with a large number of lineages.</p>
<p>That said, trajectory inference is often one of the last computational methods in a very long analysis pipeline (generally including gene-level quantification, gene filtering / feature selection, and dimensionality reduction). Hence, we strongly discourage the reader from putting too much faith in any p-value that comes out of this analysis. Such values may be useful suggestions, indicating particular features or cells for follow-up study, but should generally not be treated as meaningful statistical quantities.</p>
<p>If some commands and parameters are still unclear after going through this vignette, do not hesitate to open an issue on the <em>condiments</em> <a href="https://%E2%80%8Bgithub.com/%E2%80%8BHectorRDB/%E2%80%8Bcondiments/issues">Github repository</a>.</p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R Under development (unstable) (2021-04-05 r80145)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] caret_6.0-86                 ggplot2_3.3.3               
##  [3] lattice_0.20-41              slingshot_1.99.3            
##  [5] TrajectoryUtils_0.99.2       SingleCellExperiment_1.13.12
##  [7] SummarizedExperiment_1.21.2  Biobase_2.51.0              
##  [9] GenomicRanges_1.43.4         GenomeInfoDb_1.27.9         
## [11] IRanges_2.25.6               S4Vectors_0.29.12           
## [13] BiocGenerics_0.37.1          MatrixGenerics_1.3.1        
## [15] matrixStats_0.58.0           princurve_2.1.6             
## [17] condiments_0.99.14           knitr_1.31                  
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_2.0-0          deldir_0.2-10            
##   [3] ellipsis_0.3.1            class_7.3-18             
##   [5] rprojroot_2.0.2           XVector_0.31.1           
##   [7] fs_1.5.0                  proxy_0.4-25             
##   [9] spatstat.data_2.1-0       prodlim_2019.11.13       
##  [11] fansi_0.4.2               lubridate_1.7.10         
##  [13] sparseMatrixStats_1.3.7   codetools_0.2-18         
##  [15] splines_4.1.0             cachem_1.0.4             
##  [17] polyclip_1.10-0           jsonlite_1.7.2           
##  [19] pROC_1.17.0.1             kernlab_0.9-29           
##  [21] spatstat.linnet_2.1-1     spatstat.sparse_2.0-0    
##  [23] compiler_4.1.0            Matrix_1.3-2             
##  [25] fastmap_1.1.0             htmltools_0.5.1.1        
##  [27] tools_4.1.0               igraph_1.2.6             
##  [29] gtable_0.3.0              glue_1.4.2               
##  [31] GenomeInfoDbData_1.2.4    RANN_2.6.1               
##  [33] reshape2_1.4.4            dplyr_1.0.5              
##  [35] Rcpp_1.0.6                spatstat_2.1-0           
##  [37] jquerylib_0.1.3           pkgdown_1.6.1            
##  [39] vctrs_0.3.7               debugme_1.1.0            
##  [41] nlme_3.1-152              DelayedMatrixStats_1.13.5
##  [43] iterators_1.0.13          timeDate_3043.102        
##  [45] gower_0.2.2               xfun_0.22                
##  [47] stringr_1.4.0             Ecume_0.9.1              
##  [49] lifecycle_1.0.0           goftest_1.2-2            
##  [51] zlibbioc_1.37.0           MASS_7.3-53.1            
##  [53] scales_1.1.1              ipred_0.9-11             
##  [55] spatstat.core_2.0-0       ragg_1.1.2               
##  [57] spatstat.utils_2.1-0      yaml_2.2.1               
##  [59] memoise_2.0.0             pbapply_1.4-3            
##  [61] sass_0.3.1                rpart_4.1-15             
##  [63] stringi_1.5.3             highr_0.8                
##  [65] desc_1.3.0                randomForest_4.6-14      
##  [67] foreach_1.5.1             e1071_1.7-6              
##  [69] BiocParallel_1.25.5       lava_1.6.9               
##  [71] rlang_0.4.10              pkgconfig_2.0.3          
##  [73] systemfonts_1.0.1         bitops_1.0-6             
##  [75] evaluate_0.14             purrr_0.3.4              
##  [77] tensor_1.5                recipes_0.1.15           
##  [79] transport_0.12-2          tidyselect_1.1.0         
##  [81] plyr_1.8.6                magrittr_2.0.1           
##  [83] R6_2.5.0                  generics_0.1.0           
##  [85] DelayedArray_0.17.10      mgcv_1.8-34              
##  [87] pillar_1.5.1              withr_2.4.1              
##  [89] survival_3.2-10           abind_1.4-5              
##  [91] RCurl_1.98-1.3            nnet_7.3-15              
##  [93] tibble_3.1.0              crayon_1.4.1             
##  [95] utf8_1.2.1                spatstat.geom_2.0-1      
##  [97] rmarkdown_2.7             grid_4.1.0               
##  [99] data.table_1.14.0         ModelMetrics_1.2.2.2     
## [101] digest_0.6.27             textshaping_0.3.3        
## [103] munsell_0.5.0             bslib_0.2.4</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Lopez-Paz2016" class="csl-entry">
Lopez-Paz, David, and Maxime Oquab. 2016. <span>“<span>Revisiting Classifier Two-Sample Tests</span>.”</span> <em>Arxiv</em>, October, 1–15. <a href="http://arxiv.org/abs/1610.06545">http://arxiv.org/abs/1610.06545</a>.
</div>
<div id="ref-smirnov1939estimation" class="csl-entry">
Smirnov, Nikolai V. 1939. <span>“On the Estimation of the Discrepancy Between Empirical Curves of Distribution for Two Independent Samples.”</span> <em>Bull. Math. Univ. Moscou</em> 2 (2): 3–14.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hector Roux de Bezieux, Koen Van den Berge, Kelly Street.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
